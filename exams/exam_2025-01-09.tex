\documentclass[12pt,a4paper]{exam}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{enumitem}

\geometry{a4paper, margin=2cm}

\usepackage{cprotect}

\usepackage{xcolor}
\definecolor{maroon}{cmyk}{0, 0.87, 0.68, 0.32}
\definecolor{halfgray}{gray}{0.55}
\definecolor{ipython-frame}{RGB}{207, 207, 207}
\definecolor{ipython-bg}{RGB}{247, 247, 247}
\definecolor{ipython-red}{RGB}{186, 33, 33}
\definecolor{ipython-green}{RGB}{0, 128, 0}
\definecolor{ipython-cyan}{RGB}{64, 128, 128}
\definecolor{ipython-purple}{RGB}{170, 34, 255}
\usepackage{listings}
\lstdefinelanguage{iPython}{
	morekeywords={access,and,del,except,exec,in,is,lambda,not,or,raise},
	morekeywords=[2]{for,print,abs,all,any,basestring,bin,bool,bytearray,callable,chr,classmethod,cmp,compile,complex,delattr,dict,dir,divmod,enumerate,eval,execfile,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,isinstance,issubclass,iter,len,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,property,range,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip,apply,buffer,coerce,intern,elif,else,if,continue,break,while,class,def,return,try,except,import,finally,try,except,from,global,pass, True, False},
	sensitive=true,
	morecomment=[l]\#,%
	morestring=[b]',%
	morestring=[b]",%
	moredelim=**[is][\color{black}]{@@}{@@},
	%%
	%morestring=[s]{'''}{'''},% used for documentation text (mulitiline strings)
	%morestring=[s]{"""}{"""},% added by Philipp Matthias Hahn
	%%
	%morestring=[s]{r'}{'},% `raw' strings
	%morestring=[s]{r"}{"},%
	%morestring=[s]{r'''}{'''},%
	%morestring=[s]{r"""}{"""},%
	%morestring=[s]{u'}{'},% unicode strings
	%morestring=[s]{u"}{"},%
	%morestring=[s]{u'''}{'''},%
	%morestring=[s]{u"""}{"""}%
	%
	% {replace}{replacement}{lenght of replace}
	% *{-}{-}{1} will not replace in comments and so on
	%literate=
	%{\%}{{{\color{ipython-purple}+}}}1,
	%{á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1,
	%{Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
	%{à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
	%{À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
	%{ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
	%{Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
	%{â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
	%{Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
	%{œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
	%{ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
	%{€}{{\EUR}}1 {£}{{\pounds}}1
	%
	%{^}{{{\color{ipython_purple}\^{}}}}1
	%{=}{{{\color{ipython_purple}=}}}1
	%%
	%*{-}{{{\color{ipython_purple}-}}}1
	%{*}{{{\color{ipython_purple}$^\ast$}}}1
	%{/}{{{\color{ipython_purple}/}}}1%%
	%{+=}{{{+=}}}1
	%{-=}{{{-=}}}1
	%{*=}{{{$^\ast$=}}}1
	%{/=}{{{/=}}}1,
	%
	identifierstyle=\color{black}\footnotesize\ttfamily,
	commentstyle=\color{ipython-cyan}\footnotesize\itshape\ttfamily,
	stringstyle=\color{ipython-red}\footnotesize\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	frame=single,
	frameround={t}{t}{t}{t},
	%framexleftmargin=6mm,
	%numbers=left,
	%numberstyle=\color{ipython-cyan},
	backgroundcolor=\color{ipython-bg},
	%   extendedchars=true,
	basicstyle=\footnotesize\ttfamily,
	keywordstyle=[2]\color{ipython-green}\bfseries\footnotesize\ttfamily, 
	keywordstyle=\color{ipython-purple}\bfseries\footnotesize\ttfamily
}

\lstdefinelanguage{iOutput} {
	sensitive=true,
	identifierstyle=\color{black}\small\ttfamily,
	stringstyle=\color{ipython-red}\small\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	%frame=single,
	%frameround={t}{t}{t}{t},
	%backgroundcolor=\color{ipython-bg},
	basicstyle=\small\ttfamily,
}

\lstnewenvironment{ipython}[1][]{\lstset{language=iPython,mathescape=true,escapeinside={*@}{@*}}%
}{%
}

\lstnewenvironment{ioutput}[1][]{\lstset{language=iOutput,mathescape=true,escapeinside={*@}{@*}}%
}{%
}

\title{Financial Market Course 24/25\\ Exam}
\author{Prof. Simone Freschi, Prof. Matteo Sani}
\date{$9^{\mathrm{th}}$ January 2025}

\printanswers
%\noprintanswers
\begin{document}
\maketitle
%\addpoints{exam}
\begin{center}
\fbox{\fbox{\parbox{5.5in}{\centering
Answer the questions in the spaces provided. If you run out of room for an answer, continue on the page back.}}}
\end{center}

\begin{center}
\vspace{5mm}
\makebox[0.75\textwidth]{Student's name:\enspace\hrulefill}
\end{center}

\section*{Questions}
\vspace{.5cm}
\begin{questions}
\question Describe the equation for the expected return for a horizon of 1y of a 10y bond (with a coupon \textbf{C}, duration \textbf{D} and convexity \textbf{Conv}) given the expectation of interest rate movements equal to $\delta r$.
\begin{enumerate}[label=(\alph*),font=\itshape]
\item What will happen if the curve is inverted (short rates are higher than long rates) such as in the USA now, if rates remain unchanged from now to the horizon? 
\item what will happen if the curve is upward sloping but there is a parallel shift in 1y time?
\end{enumerate}
\fillwithlines{3cm}
\begin{solution}
%%%% SOLUTION EX 1
\end{solution}

\question Describe the equation for the return attribution model by Brinson, Hood and Beebower (BHB). 
\begin{enumerate}[label=(\alph*),font=\itshape]
\item Explain the difference between Allocation Effect and Security Selection Effect 
\item Imagine that your portfolio is overweight Energy (30\% vs 20\% Benchmark) and the Energy sector is up 15\%. Your energy stocks in the portfolio are up only 5\%. Determine the allocation effect and the selection effect and the overall portfolio result.
\end{enumerate}
\fillwithlines{3cm}
\begin{solution}
%%%% SOLUTION EX 2
\end{solution}

%\question[15] 	Describe the price in real terms and nominal terms of an Inflation Linked Bond.
%\begin{enumerate}
%\item What will happen to the price if nominal rates rise of 1\% and inflation rises of 2\%.
%\item If real rates are 1\% and nominal rates are 5\% (so brekeven inflation is equal to 4\%). What will happen to the Inflation Linked Bond if breakevens go down of 1\% and real rates remain the same? And what will happen to a Nominal Bond with the same maturity?
%
%\end{enumerate}
%\fillwithlines{3cm}
%
%\question[15] Describe the asset swap contract for a coupon bond with coupons equal to \textbf{C} and dirty Price equal to $P(t)$.	
%\begin{enumerate}
%\item What will happen to the price if the spread increase, all the rest being equal? What does it mean in term of credit quality expectation by the market for the bond's issuer?
%\item What is the difference between asset swap spread and \textbf{G-spread} or \textbf{I-spread} calculated in Bloomberg screen?
%\end{enumerate}
%\fillwithlines{3cm}

%\question[20] What is \texttt{numpy} array ?
%\fillwithlines{3cm}
%\begin{solution}
%\texttt{numpy} arrays are array structure more flexible then standard \texttt{python} lists. By using \texttt{numpy} arrays reading and writing items is faster and more efficient.
%\end{solution}

\question
What should we put instead of the \texttt{?} to make the following boolean expression \texttt{True} ?
\begin{ipython}
True and False or ?
\end{ipython}
\fillwithlines{1cm}
\begin{solution}
You need \texttt{?=True} since the boolean operators have the same precedence so the expression is evaluated from left to right.
Hence
\begin{equation*}
  \begin{gathered}
    \underbrace{\texttt{True and False}}_{\texttt{False}}\texttt{ or ?} = \texttt{True} \\
    \texttt{False or ?} = \texttt{True} \implies \texttt{?} = \texttt{True} \\
    \end{gathered}
\end{equation*}
\end{solution}

\question
You are evaluating an investment opportunity. Assuming the initial payment is $P_0 = \$350,000$, the project is expected to generate the following cash flows:
\begin{itemize}
\item $CF(t=\text{1y})=\$100,000$
\item $CF(t=\text{2y})=\$150,000$
\item $CF(t=\text{3y})=\$200,000$
\end{itemize}
Your required rate of return for this investment is 10\%. Is this investment financially viable ?
\fillwithlines{3cm}
\begin{solution}
Calculate the discount factor for each year ($df=1 / (1 + r)^t$) where $r$ is the discount rate and $t$ is the time period.
\begin{itemize}
\item $df(t=\text{1y})=1 / (1 + 0.10)^1 = 0.9091$
\item $df(t=\text{2y})=1 / (1 + 0.10)^2 = 0.8264$
\item $df(t=\text{3y})=1 / (1 + 0.10)^3 = 0.7513$
\end{itemize}

Then calculate the present value of each cash flow ($PV=CF\times df$)
\begin{itemize}
\item $PV(t=\text{1y})=\$100,000\cdot 0.9091 = \$90,910$
\item $PV(t=\text{2y})=\$150,000\cdot 0.8264 = \$123,960$
\item $PV(t=\text{3y})=\$200,000\cdot 0.7513 = \$150,260$
\end{itemize}

Finally calculate the Net Present Value (NPV) of the project ($NPV = \sum PV_i  - P_0$)
Solutions:
\begin{equation*}
NPV = \$90,910 + \$123,960 + \$150,260 - \$350,000 = -\$84,870
\end{equation*}

Since the $NPV$ is negative, the investment is not expected to generate returns that exceed your required rate of return. Therefore, based on this analysis, the investment is not considered financially viable.
\end{solution}

\question 
A financial institution has entered into an interest rate swap with Company A. Under the terms of the swap, it receives 10\% per annum and pays 6-month LIBOR on a principal of \$10 M for 5 years. Payments are made every 6 months. 

Suppose that Company A defaults just before the sixth payment date (at the end of year 3) when the 6-month LIBOR is 9\% per annum.
Assuming the forward rate is 8\% per annum for all maturities, what is the loss to the financial institution ? 
\makeemptybox{3cm}

\begin{solution}
Cash flows before default:
\begin{itemize}
\item The swap has been running for 3 years, meaning 6 payments have been made. We only need to consider the payments after the default to understand its impact.
Halfway through year 3, 6-month LIBOR was 9\% per annum. This means the financial institution paid $9\%/2 * \$10 M = \$450,000$ to Company A. The financial institution receives instead $10\%/2 * \$10 M = \$500,000$ from Company A every six months.
\item The swap was supposed to continue for another 2 years (4 remaining payments). We need to calculate the present value of the remaining cash flows that the financial institution would have received had Company A not defaulted.
Since we are given a flat term structure of 8\% with semiannual compounding for all maturities as of the default date, we can use it to discount the future cash flows. Here's a breakdown of the remaining cash flows and their present values:

The financial institution would have received \$500,000 and paid $8\%/2 * \$10 M = \$400,000$ for a net cash flow: $\$500,000 - \$400,000 = \$100,000$ for each payment. The resulting PVs are:
\begin{itemize}
\item $PV_7 = \$100,000 / (1 + 0.08/2)^1 = \$96,153.85$
\item $PV_8 = \$100,000 / (1 + 0.08/2)^2 = \$92,455.63$
\item $PV_{9} = \$100,000 / (1 + 0.08/2)^3 = \$88,900$
\item $PV_{10} = \$100,000 / (1 + 0.08/2)^4 = \$85,480.40$
\end{itemize}
\end{itemize}

Then total loss is the sum of the present values of the lost cash flows: $\$96,153.85 + \$92,455.63 + \$88,900 + \$85,480.40 + \$50,000 = \$412,990$.
\end{solution}

\question An exotic derivative has a very complicated payoff, such that to valuate it you are forced to use Monte Carlo simulation. 
At first you decide to run a MC involving just 50 scenarios which results in a contract value of 314,159.26€ $\pm$ 2.72\%. After presenting your results you boss is not that happy and ask you to determine more precisely the derivative value at the next group meeting in 1 hour. Assuming each simulation lasts about 1.8 seconds, what is the highest precision you can achieve of the derivative value ?
\makeemptybox{5cm}

\begin{solution}
Given you have to answer in 1 hour, you can run at most: $\cfrac{3600}{1.8}=2000$ experiments. Since the result precision scale as the square root of the number of simulations
\begin{equation*}
\textrm{new uncertainty} = 0.0272 \cdot \sqrt{\frac{50}{2000}} \approx 0.0043
\end{equation*}
\end{solution}

\end{questions}
\end{document}
