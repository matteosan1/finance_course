\documentclass[12pt,a4paper]{exam}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{enumitem}

\geometry{a4paper, margin=2cm}

\usepackage{cprotect}

\usepackage{xcolor}
\definecolor{maroon}{cmyk}{0, 0.87, 0.68, 0.32}
\definecolor{halfgray}{gray}{0.55}
\definecolor{ipython-frame}{RGB}{207, 207, 207}
\definecolor{ipython-bg}{RGB}{247, 247, 247}
\definecolor{ipython-red}{RGB}{186, 33, 33}
\definecolor{ipython-green}{RGB}{0, 128, 0}
\definecolor{ipython-cyan}{RGB}{64, 128, 128}
\definecolor{ipython-purple}{RGB}{170, 34, 255}
\usepackage{listings}
\lstdefinelanguage{iPython}{
	morekeywords={access,and,del,except,exec,in,is,lambda,not,or,raise},
	morekeywords=[2]{for,print,abs,all,any,basestring,bin,bool,bytearray,callable,chr,classmethod,cmp,compile,complex,delattr,dict,dir,divmod,enumerate,eval,execfile,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,isinstance,issubclass,iter,len,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,property,range,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip,apply,buffer,coerce,intern,elif,else,if,continue,break,while,class,def,return,try,except,import,finally,try,except,from,global,pass, True, False},
	sensitive=true,
	morecomment=[l]\#,%
	morestring=[b]',%
	morestring=[b]",%
	moredelim=**[is][\color{black}]{@@}{@@},
	%%
	%morestring=[s]{'''}{'''},% used for documentation text (mulitiline strings)
	%morestring=[s]{"""}{"""},% added by Philipp Matthias Hahn
	%%
	%morestring=[s]{r'}{'},% `raw' strings
	%morestring=[s]{r"}{"},%
	%morestring=[s]{r'''}{'''},%
	%morestring=[s]{r"""}{"""},%
	%morestring=[s]{u'}{'},% unicode strings
	%morestring=[s]{u"}{"},%
	%morestring=[s]{u'''}{'''},%
	%morestring=[s]{u"""}{"""}%
	%
	% {replace}{replacement}{lenght of replace}
	% *{-}{-}{1} will not replace in comments and so on
	%literate=
	%{\%}{{{\color{ipython-purple}+}}}1,
	%{á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1,
	%{Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
	%{à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
	%{À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
	%{ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
	%{Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
	%{â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
	%{Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
	%{œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
	%{ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
	%{€}{{\EUR}}1 {£}{{\pounds}}1
	%
	%{^}{{{\color{ipython_purple}\^{}}}}1
	%{=}{{{\color{ipython_purple}=}}}1
	%%
	%*{-}{{{\color{ipython_purple}-}}}1
	%{*}{{{\color{ipython_purple}$^\ast$}}}1
	%{/}{{{\color{ipython_purple}/}}}1%%
	%{+=}{{{+=}}}1
	%{-=}{{{-=}}}1
	%{*=}{{{$^\ast$=}}}1
	%{/=}{{{/=}}}1,
	%
	identifierstyle=\color{black}\footnotesize\ttfamily,
	commentstyle=\color{ipython-cyan}\footnotesize\itshape\ttfamily,
	stringstyle=\color{ipython-red}\footnotesize\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	frame=single,
	frameround={t}{t}{t}{t},
	%framexleftmargin=6mm,
	%numbers=left,
	%numberstyle=\color{ipython-cyan},
	backgroundcolor=\color{ipython-bg},
	%   extendedchars=true,
	basicstyle=\footnotesize\ttfamily,
	keywordstyle=[2]\color{ipython-green}\bfseries\footnotesize\ttfamily, 
	keywordstyle=\color{ipython-purple}\bfseries\footnotesize\ttfamily
}

\lstdefinelanguage{iOutput} {
	sensitive=true,
	identifierstyle=\color{black}\small\ttfamily,
	stringstyle=\color{ipython-red}\small\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	%frame=single,
	%frameround={t}{t}{t}{t},
	%backgroundcolor=\color{ipython-bg},
	basicstyle=\small\ttfamily,
}

\lstnewenvironment{ipython}[1][]{\lstset{language=iPython,mathescape=true,escapeinside={*@}{@*}}%
}{%
}

\lstnewenvironment{ioutput}[1][]{\lstset{language=iOutput,mathescape=true,escapeinside={*@}{@*}}%
}{%
}


\title{Advanced Financial Modeling Course 23/24\\ Exam}
\author{Prof. Andrea Carapelli, Prof. Matteo Sani}
\date{$16^{\mathrm{th}}$ February 2024}

%\printanswers
\noprintanswers
\begin{document}
\maketitle
%\addpoints{exam}
\begin{center}
\fbox{\fbox{\parbox{5.5in}{\centering
Answer the questions in the spaces provided. If you run out of room for an answer, continue on the page back.}}}
\end{center}

\begin{center}
\vspace{5mm}
\makebox[0.75\textwidth]{Student's name:\enspace\hrulefill}
\end{center}

\section*{Questions}
\vspace{.5cm}
\begin{questions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\question Consider the process $Y(t) = 2^{W(t)}, where $\{W(T):t\geq 0\}$ is a standard Brownian motion. Is this a martingale ?
\fillwithlines{3cm}
\begin{solution}
With $g(t)=2^{W(t)}$, we find:
\begin{equation*}
dg(t) = \ln2\cdot 2^{W(t)}dW(t) +\cfrac{(\ln2)^2}{2}2^{W(t)}dt
\end{equation*}
Note that $g, g_{x}, g_{xx}$ exist and are continouos. 
Due to the appearance of a $dt$-term, the process is not a martingale.
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\question Let $\{W(T):t\geq 0\}$ be a Brownian motion on a probability space and let $\mathcal{F}_t$ be its natural filtration. Consider a stock with price process $\{S(t):0\leq t \leq T\}$, with 
\begin{equation*}
S(t)=S(0)\exp\left{\int_0^t eì{-u}dW(u) + \int_0^t(1-\frac{1}{2}e^{-2u}du\right}
\end{equation*}
\begin{enumerate}[label=(\alph*),font=\itshape]
\item Let 
\begin{equation*}
X(t)=\int_0^te^{-u}dW(u)+\int_0^t(1-\frac{1}{2}e^{-2u}du\right}
\end{equation*}
and determine the distribution of $X(t).
\item Prove that $\{S(t):t\geq 0\}$ is an Ito process.
\item Let $r$ be a constant interest rate. Find the risk-neutral measure $\tilde{\mathcal{P}}$, equivalent to $\mathcal{P}$, such that the discounted price process $\{we^{-rt}S(t): 0\leq t \leq T\}$ is a martingale under $\tilde{\mathcal{P}}$.
\end{enumerate}
\fillwithlines{3cm}
\begin{solution}
\begin{enumerate}[label=(\alph*),font=\itshape]
\item Let $Y(t)=\int_0^t e^{-u}dW(u)$, or the first term of the $X(t)$ process. From the stochastic calculus results we know that $Y(t)$ is normally distributed with $\mathbb{E}[Y(t)]=0$ and 
\begin{equation*}
\text{Var}[Y(t)]=\int_0^t e^{-2u}du = \frac{1}{2}(1-e^{-2t})$
\end{equation*} 
Since 
\begin{equation*}
X(t) = Y(t) + \int_0^t (1-\frac{1}{2}e^{-2u})du = Y(t) + t + \frac{1}{4}(e^{-2t}-1)$
\end{equation*} 
we see that $X(t)$ is normally distributed, with mean 
\begin{equation*}
\mathbb{E}[X(t)] = t + \frac{1}{4}(e^{-2t}-1)$
\end{equation*} 
and variance
\begin{equation*}
\text{Var}[X(t)} = \text{Var}[Y(t)] = \frac{1}{2}(1-e^{-2t})$
\end{equation*} 
\item With 
\begin{equation*}
X(t) = \int_0^t e^{-u}dW(u) + \int_0^t (1-\frac{1}{2}e^{-2u})du$
\end{equation*} 
we have 
\begin{equation*}
dX(t) = e^{-t}dW(t) + (1-\frac{1}{2}e^{-2t})dt$
\end{equation*} 
and $dX(t)dX(t)=e^{-2t} dt$. Note that $S(t)=S(0)e^{X(t)}$, so let $f(x)=S(0)e^x$, then $f_x(x)=f_{xx}(x)=f(x)$. By the Ito formula we get
\begin{equation*}
\begin{aligned}
dS_t &= df(X_t) = S_tdX+\frac{1}{2}S(t)dXdX = \\
&=S_t\left(e^{-t}dW + (1-\frac{1}{2}e^{-2t})dt\right)+\frac{1}{2}S_t e^{-2t}dt = \\
&=S_t dt+S_t e^{-t}dW
\end{aligned}
\end{equation*}
This shows that $S_t$ is an Ito process.
\item Define 
\begin{equation*}
\theta(r)=\cfrac{1-r}{e^{-t}}=e^t (1-r)
\end{equation*}
Consider the random variable $Z$, defined by
\begin{equation*}
\begin{aligned}
Z &= \exp\left(-\int_0^T \theta(u)dW(u) - \frac{1}{2}\int_0^T \theta^2(u)du\right) = \\
&=\exp\left(-\int_0^T e^u (1-r)dW(u) - \frac{1}{2}\int_0^T e^{2u} (1-r)^2 du\right)
\end{aligned}
\end{equation*}
Define the measure $\tilde{\mathcal{P}}$ by $\tilde{\mathcal{P}}(A) =\int_A Z d\mathcal{P}$ and consider the process 
\begin{equation*}
\begin{aligned}
\tilde{W}_t = \int_0^t \theta(u)dW(u) +W(t) = \int_0^t e^{u}(1-r)du+W(t)=(1-r)(e^t -1)+W(t)
\end{equation*}
By Girsanov Theorem $\tilde{W}$ is a Brownian motion under $\tilde{\mathcal{P}}$ and hence it is a martingale under $\tilde{\mathcal{P}}$. 
Using the SDE of part (a), together with the Ito product rule, we have 
\begin{equation*}
\begin{aligned}
d(e^{-rt}S(t)) &= e^{-rt}dS_t-r e^{-rt}S_t dt = \\
&= e^{-rt}(S_t dt + S_te^{-t}dW)-re^{-rt}S_t = \\
&= e^{-rt}S_t((1-r)dt + e^{-t}dW)) = \\
&= e^{-rt}S_t(e^{-t}\theta_t dt + e^{-t}dW)) = \\
&= e^{-t(r+1)}S_t d\tilde{W}_t
\end{aligned}
\end{equation*}
Since $e^{-rt}S(t)$ is an Ito integral, we see that the discounted price process is a martingale under $\tilde{\mathcal{P}}$.
\end{enumerate}
\end{solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\question Suppose that $X(t)$ satisfies the following SDE:
\begin{equation*}
dX_t = 0.04X_t dt + \sigma X_t dW_t
\end{equation*}
and $Y_t$ satisfies:
\begin{equation*}
dY_t = \beta Y_t dt + 0.1 Y_t dW_t
\end{equation*}
Parameters $\beta, \sigma$ are postive and both processes are driven by the same Brownian Motion $W(t)$.
For a given process
\begin{equation*}
Z_t = 2\cfrac{X_t}{Y_t}-\lambda t
\end{equation*}
with $\lambda\in\mathbb{R}^+$.
\begin{enumerate}[label=(\alph*),font=\itshape]
\item Find the SDE for $Z_t$;
\item For which values of $\beta$ and $\lambda$ is the process $Z_t$ a martingale ?

\fillwithlines{3cm}à
\begin{solution}
\begin{enumerate}[label=(\alph*),font=\itshape]
\item We have 
\begin{equation*}
\begin{gathered}
X_t = e^{\sigma W_t-\frac{\sigma^2}{2}t+0.04 t}\\
dX_t = 0.04 X_t dt + \sigma X_t dW_t\\
Y_t = e^{0.1W_t -\frac{0.01}{2}t+\beta t}\\
dY_t = \beta Y_t dt + 0.1 Y_t dW_t
\end{gathered}
\end{equation*}
Using the expressions fot $X_t$ and $Y_t$ we get
\begin{equation*}
Z_t = 2\exp\left((\sigma-0.1)W_t + (0.04+\frac{0.01}{2}-\beta-\frac{\sigma^2}{2})t\right)-\lambda t
\end{equation*}
\item A martingale process does not contain a drift term. We have 
\begin{equation*}
dZ_t = (Z+\lambda t)(0.01+0.04-\beta-0.1\sigma)dt-\lambda dt + (Z+\lambda t)(\sigma-0.1)dW_t
\end{equation*}
With $\beta$ and $\sigma$ constant and $\lambda\in\mathbb{R}^+$, the necessary conditions for a vanishing drift term are $\lambda=0$ and
\begin{equation*}
0.01+0.04-\beta-0.1\sigma=0\implies \beta=0.05-0.15\sigma
\end{equation*}
%To check this result we employ the Ito derivative rules for multivariate functions...
\end{enumerate}
\end{solution}


\end{questions}
\end{document}
