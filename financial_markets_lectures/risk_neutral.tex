\chapter{Risk Neutral Measure}
\label{risk-neutral}

\section{Discrete single-period model}
\label{sec:risk_neutral1}
Assume that today's stock price is $ğ‘†_0$, and one period from now, the stock price can be $ğ‘†_0\cdot u = ğ‘†_ğ‘¢$ or $ğ‘†_0\cdot ğ‘‘ = ğ‘†_ğ‘‘$, with $ğ‘¢$ and $ğ‘‘$ being "up" and "down" multiplicative factors. Assume also that the risk-free rate is $ğ‘Ÿ$.

Without imposing some conditions on $ğ‘¢$, $ğ‘‘$ and $ğ‘Ÿ$, there might be some arbitrage opportunities. If for example $ğ‘’^{r} > ğ‘¢$, I could short the stock at time $ğ‘¡_0$ and invest the proceeds $ğ‘†_0$ into the risk-free account: in both future states at time $ğ‘¡_1$, I could then buy the stock back for less than my proceeds $ğ‘†_0 ğ‘’^{ğ‘Ÿ}$ from the risk free (because $ğ‘†_ğ‘¢$ and $ğ‘†_ğ‘‘$ would both be less than $ğ‘†_0 ğ‘’^{r}$).

If, on the other hand, $ğ‘’^{r} < ğ‘‘$, I could borrow exactly $ğ‘†_0$ money at $ğ‘¡_0$ to buy the stock, and in both future states of the world at time $ğ‘¡_1$, the stock value would be higher than what I would have to repay ($ğ‘†_0 ğ‘’^{r}$): so there would be arbitrage again.

Imposing $ğ‘‘ \le e^{r} \le ğ‘¢$, will ensure no arbitrage in the one-period model.

Now I am going to perform the following algebraic manipulation:

\begin{align}
\begin{split}
ğ‘†_0 &=ğ‘†_0 \frac{(ğ‘¢âˆ’ğ‘‘)}{(ğ‘¢âˆ’ğ‘‘)} = \\
&=\frac{1}{ğ‘’^{r}}ğ‘†_0 \frac{(ğ‘¢âˆ’ğ‘‘)ğ‘’^{r}}{(ğ‘¢âˆ’ğ‘‘)}= \\
&=\frac{1}{ğ‘’^{r}}ğ‘†_0 \frac{(ğ‘¢âˆ’ğ‘‘)ğ‘’^{r}+(ğ‘†_0ğ‘¢ğ‘‘âˆ’ğ‘†_0ğ‘¢ğ‘‘)}{(ğ‘¢âˆ’ğ‘‘)}= \\
&=\frac{1}{ğ‘’^{r}}\left(\frac{ğ‘†_0ğ‘¢ğ‘’^{ğ‘Ÿ}âˆ’(ğ‘†_0ğ‘¢ğ‘‘)}{ğ‘¢âˆ’ğ‘‘}+\frac{âˆ’ğ‘†_0ğ‘‘ğ‘’^{ğ‘Ÿ}+(ğ‘†_0ğ‘¢ğ‘‘)}{ğ‘¢âˆ’ğ‘‘}\right)= \\
&=\frac{1}{ğ‘’^{r}}(ğ‘†_0ğ‘¢ \left(\frac{ğ‘’^{ğ‘Ÿ}âˆ’ğ‘‘}{ğ‘¢âˆ’ğ‘‘}\right)+ğ‘†_0ğ‘‘\left(\frac{ğ‘¢âˆ’ğ‘’^{ğ‘Ÿ}}{ğ‘¢âˆ’ğ‘‘}\right))
\end{split}
\end{align}

The no arbitrage condition $ğ‘‘ \le e^{r} \le ğ‘¢$ will result in the following bounds 

\begin{equation}
\begin{cases}
0 \le \dfrac{ğ‘’^{ğ‘Ÿ}âˆ’ğ‘‘}{ğ‘¢âˆ’ğ‘‘} \le 1 \\ 
0 \le \dfrac{ğ‘¢âˆ’ğ‘’^{r}}{ğ‘¢âˆ’ğ‘‘} \le 1
\end{cases}
\end{equation}

Furthermore:

\begin{equation*}
\frac{ğ‘’^{ğ‘Ÿ}âˆ’ğ‘‘}{ğ‘¢âˆ’ğ‘‘}+\frac{ğ‘¢âˆ’ğ‘’^{ğ‘Ÿ}}{ğ‘¢âˆ’ğ‘‘}=1
\end{equation*}

Let's call $ğ‘’^{ğ‘Ÿ}âˆ’ğ‘‘ğ‘¢âˆ’ğ‘‘ = ğ‘_ğ‘¢$ and $ğ‘¢âˆ’ğ‘’^{ğ‘Ÿ}ğ‘¢âˆ’ğ‘‘ = ğ‘_ğ‘‘$. In the one period model, the stock going up and the stock going down are two different states of the world, i.e. there is no "intersection" between these states in the probabilistic sense. Therefore ğ‘ğ‘¢ and ğ‘ğ‘‘ are additive over disjoint sets and they are within the zero-one range, therefore mathematically, these parameters qualify as a probability measure.

Rewriting the algebraic manipulation above in terms of $ğ‘_ğ‘¢$ and $ğ‘_ğ‘‘$ yields the following:

\begin{equation}
ğ‘†_0=\frac{ğ‘†_ğ‘¢ ğ‘_ğ‘¢ +ğ‘†_ğ‘‘ ğ‘_ğ‘‘}{ğ‘’^{ğ‘Ÿ}}=\frac{1}{ğ‘’^{r}}\mathbb{E}[ğ‘†_1]
\end{equation}

Also notice that in the entire construction above, we did not talk about the probabilities of the stock going up or down. Every market participant might have his or her Bayesian view of the world with different probabilities assigned to the stock going up or down. But the risk-neutral measure is agreed upon by the market as a whole as a consequence of no arbitrage.

This also brings up an interesting point: in my view, the risk neutral probabilities are probabilities only in the "mathematical object" sense. They do not actually represent "likelihoods", in the sense that we human beings like to interpret probabilistic events with.

\section{Pricing Derivatives}
Let's assume we want to price a derivative on the stock with pay-off function $ğ‘‰(ğ‘†_ğ‘¡)$ (could be a forward, option, whatever). The derivative pay-off in the two states will trivially be $ğ‘‰(ğ‘†_ğ‘¢)$ and $ğ‘‰(ğ‘†_ğ‘‘)$. We have two states, two underlying instruments: let's try to replicate the derivative pay-off in both states ($ğ‘¥$ is the number of stocks and $ğ‘¦$ is the amount invested in the risk-free account: I want to replicate the derivative pay-off in both states with $ğ‘¥$ stocks and $ğ‘¦$ risk-free investment):

\begin{equation}
\begin{split}
ğ‘¥ğ‘†_ğ‘¢+ğ‘¦ğ‘’^{ğ‘Ÿ}=ğ‘‰(ğ‘†_ğ‘¢)\\
ğ‘¥ğ‘†_ğ‘‘+ğ‘¦ğ‘’^{ğ‘Ÿ}=ğ‘‰(ğ‘†_ğ‘‘)
\end{split}
\end{equation}

Solving gives:

\begin{align}
\begin{split}
ğ‘¥&=\frac{ğ‘‰(ğ‘†_ğ‘¢)âˆ’ğ‘‰(ğ‘†_ğ‘‘)}{ğ‘†_0(ğ‘¢âˆ’ğ‘‘)}\\
ğ‘¦&=\frac{ğ‘¢ğ‘‰(ğ‘†_ğ‘‘)âˆ’ğ‘‘ğ‘‰(ğ‘†_ğ‘¢)}{(ğ‘¢âˆ’ğ‘‘)}\frac{1}{ğ‘’^{ğ‘Ÿ}}
\end{split}
\end{align}

Therefore the derivative price at time $ğ‘¡_0$ is the $ğ‘¥$ amount of the stock + $ğ‘¦$ amount invested in the risk-free account:

\begin{equation}
ğ‘‰(ğ‘†_0,ğ‘¡_0) =ğ‘¥\cdot ğ‘†_0+ğ‘¦\cdot 1 =\frac{ğ‘‰(ğ‘†_ğ‘¢)âˆ’ğ‘‰(ğ‘†_ğ‘‘)}{ğ‘†_0(ğ‘¢âˆ’ğ‘‘)}\cdot ğ‘†_0 + \frac{ğ‘¢ğ‘‰(ğ‘†_ğ‘‘)âˆ’ğ‘‘ğ‘‰(ğ‘†_ğ‘¢)}{(ğ‘¢âˆ’ğ‘‘)}\frac{1}{e^{r}}\cdot 1
\end{equation}

The above evaluates to:
\begin{equation}
\frac{1}{e^{r}}\left(ğ‘‰(ğ‘†_ğ‘¢)\left(\frac{e^{r}âˆ’ğ‘‘}{ğ‘¢âˆ’ğ‘‘}\right)+ğ‘‰(ğ‘†_ğ‘‘)\left(\frac{ğ‘¢âˆ’e^{r}}{ğ‘¢âˆ’ğ‘‘}\right)\right)
\end{equation}

Notice that again we can write $ğ‘’^{ğ‘Ÿ}âˆ’ğ‘‘ğ‘¢âˆ’ğ‘‘ = ğ‘_ğ‘¢$ and $ğ‘¢âˆ’ğ‘’^{ğ‘Ÿ}ğ‘¢âˆ’ğ‘‘ = ğ‘_ğ‘‘$, where notably $ğ‘_ğ‘¢$ and $ğ‘_ğ‘‘$ are the same as in Section~\ref{sec:risk_neutral1} above, therefore, \textbf{instead of having to compute the replication portfolio weights $ğ‘¥$ and $ğ‘¦$}, the derivative can be priced as:

\begin{equation}
ğ‘‰(ğ‘†_0,ğ‘¡_0)=\frac{1}{e^{r}}(ğ‘‰(ğ‘†_ğ‘¢)ğ‘_ğ‘¢+ğ‘‰(ğ‘†_ğ‘‘)ğ‘_ğ‘‘)=\frac{1}{e^{r}}\mathbb{E}[ğ‘‰(ğ‘†_1,ğ‘¡_1)]
\end{equation}

The risk-neutral measure pricing technique has the following features:
\begin{itemize}
\item is a consequence of no-arbitrage assumptions in the model;
\item taking the expectation of a derivative pay-off and discounting it to today is the equivalent of computing "replication portfolio" weights at each time-step, and pricing the derivative using these replicating weights at time $ğ‘¡_0$.
\end{itemize}

\section{Continous-time Models}
Extending the one-period model leads to a multi-period "binomial tree" discrete model. Pricing a derivative on a multi-period tree would require working "backwards" from the terminal pay-off and computing the replicating portfolio pay-off at each node. Alternatively, the more convenient way is to use the risk-neutral expectation of the terminal pay-off and discounting it to "today": as that will produce the same result (as shown above) and will save us having to worry about the replicating portfolio weights.

%As a sketch, we can show that the multi-period Binomial model for the stock converges to the well-known continuous Geometric Brownian Motion (GBM) model (which in turn can be used to derive the Black-Scholes formula directly by applying the risk-neutral expectation to the option pay-off at maturity where the stock process is simulated with GBM).
%
%For the multi-period Binomial model, we have:
%
%ğ‘†ğ‘›=ğ‘†0ğ‘¢ğ‘˜ğ‘‘ğ‘›âˆ’ğ‘˜
%
%with ğ‘˜âˆ¼ğµğ‘–ğ‘›(ğ‘›,ğ‘). The "Cox-Ross-Rubinstein" parameters for "up" and "down" are then set as follows: ğ‘¢:=ğ‘’ğœ‚ğ‘‡ğ‘›+ğ‘‡ğ‘›âˆšğœ, ğ‘‘:=ğ‘’ğœ‚ğ‘‡ğ‘›âˆ’ğ‘‡ğ‘›âˆšğœ.
%
%It is well known that the Binomial distribution converges to Normal, in fact, using CLT, we get:
%
%limğ‘›â†’âˆğ‘˜âˆ’â†’ğ‘‘ğ‘(ğ‘›ğ‘,ğ‘›ğ‘(1âˆ’ğ‘)â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾âˆš)
%
%Going back to the equation for ğ‘†ğ‘›, taking a log and substituting for ğ‘¢ and ğ‘‘, we get:
%
%ğ‘™ğ‘›(ğ‘†ğ‘›ğ‘†0)=ğ‘˜(2ğ‘‡ğ‘›â€¾â€¾â€¾âˆšğœ)+ğ‘›(ğœ‚ğ‘‡ğ‘›âˆ’ğ‘‡ğ‘›â€¾â€¾â€¾âˆšğœ)
%
%Which gives:
%
%ğ”¼[ğ‘™ğ‘›(ğ‘†ğ‘›ğ‘†0)]=ğ‘‡ğ‘›â€¾â€¾â€¾âˆšğœ(2ğ‘âˆ’1)+ğœ‚ğ‘‡
%
%ğ‘‰ğ‘ğ‘Ÿ(ğ‘™ğ‘›(ğ‘‹ğ‘›ğ‘‹0))=4ğ‘‡ğœ2ğ‘(1âˆ’ğ‘))
%
%So we see that:
%
%limğ‘›â†’âˆ(ğ‘‹ğ‘›ğ‘‹0)âˆ’â†’ğ‘‘ğ‘(ğ‘‡ğ‘›â€¾â€¾â€¾âˆšğœ(2ğ‘âˆ’1)+ğœ‚ğ‘‡,2ğ‘‡â€¾â€¾âˆšğœğ‘(1âˆ’ğ‘))â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾âˆš
%
%Taking ğ‘=0.5, we get:
%
%limğ‘›â†’âˆğ‘™ğ‘›(ğ‘‹ğ‘›ğ‘‹0)âˆ’â†’ğ‘‘ğ‘(ğœ‚ğ‘‡,ğœğ‘‡â€¾â€¾âˆš)
%
%If we now set ğœ‚:=ğœ‡âˆ’0.5ğœ2, we see that the discrete multiperiod Binomial model for the stock price converges exactly to the continuous Geometric-Brownian-Motion model in distribution.
%
%Another interesting fact to note is that the replicating weight of the stock in part 1, i.e. ğ‘¥, converges to ğ‘(ğ‘‘1), i.e. the instantaneous option Delta.
%
%I will conclude by producing the same summary as Kevin, but with the following additional comments:

\section{Summary}

Risk-neutral probability measures are artificial and created by assuming the existence of no-arbitrage and completeness.

Derivatives can be priced relative to underlying assets. This hedging price can be computed as expectation with respect to the risk-neutral probability measure. Equivalent martingale measures are a consequence of arbitrage and completeness.

The risk-neutral density can be estimated from observed market data, i.e. twice differentiating the Implied Vol surface with respect to strike. The risk-neutral framework connects many different approaches to derivatives pricing.
