\usepackage{exsheets}
\SetupExSheets{counter-format=ch.qu}

\usepackage{sectsty}
\usepackage{titlesec}
\chapterfont{\color{rahmen}}
\subsectionfont{\color{rahmen}}
\subsubsectionfont{\color{rahmen}}
\titleformat{\section}
{\normalfont\Large\bfseries\color{rahmen}}{\textcolor{rahmen}\thesection}{1em}{}[\textcolor{rahmen}{\titlerule[0.1pt]}]

\patchcmd{\thebibliography}{\chapter*}{\section*}{}{}

\usepackage{afterpage}
\usepackage[inline]{enumitem}
\usepackage{cancel}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{makecell}
\setcellgapes{4pt}

\usepackage{geometry}
\geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm,headheight=14pt}
%\geometry{top=3cm,bottom=3cm,right=2cm,left=2.5cm,headheight=14pt}

\usepackage[most]{tcolorbox}
\newtcolorbox{attention}{breakable,enhanced,arc=0mm,colback=cream,colframe=goldenrod,leftrule=12mm,
	overlay={\node[anchor=north west,outer sep=2pt] at (frame.north west) {\includegraphics[width=8mm]{figures/alert.png}}; }}
\newtcolorbox{curiosity}{breakable,enhanced,arc=0mm,colback=lime,colframe=green,leftrule=12mm,
	overlay={\node[anchor=north west,outer sep=2pt] at (frame.north west) {\includegraphics[width=8mm]{figures/curiosity.png}}; }}
\newtcolorbox{finmarkets}{breakable,enhanced,arc=0mm,colback=sky,colframe=rahmen,leftrule=12mm,
	overlay={\node[anchor=north west,outer sep=2pt] at (frame.north west) {\includegraphics[width=8mm]{figures/python_logo.png}}; }}

%\usepackage{amssymb}
\usepackage{amsfonts} % for expectation and other chars
\usepackage{bbm} % for indicator function
\usepackage{eurosym} % defines \euro

\usepackage{xcolor}
\definecolor{mandellightgreen}{rgb}{0.77, 0.82, 0.73}
\definecolor{mandelpantone}{rgb}{0.2, 0.11, 0.27}
\definecolor{ipython-frame}{RGB}{207, 207, 207}
\definecolor{ipython-bg}{RGB}{247, 247, 247}
\definecolor{ipython-red}{RGB}{186, 33, 33}
\definecolor{ipython-green}{RGB}{0, 128, 0}
\definecolor{ipython-cyan}{RGB}{64, 128, 128}
\definecolor{ipython-purple}{RGB}{170, 34, 255}
\definecolor{cream}{RGB}{255,229,153}
\definecolor{goldenrod}{RGB}{218,165,32}
\definecolor{sky}{RGB}{150, 195, 255}
\definecolor{rahmen}{RGB}{0,73,114}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-green}{HTML}{00A250}

\newcommand\Pdef{P_{\text{def}}}
\newcommand\Psur{P_{\text{sur}}}
\newcommand\cov{\text{Cov}}
\newcommand\var{\text{Var}}

\usepackage{hyperref}
\hypersetup{
	breaklinks=true,  % so long urls are correctly broken across lines
	colorlinks=true,
	urlcolor=rahmen,
	linkcolor=rahmen,
	citecolor=rahmen,
}
\hypersetup{linkcolor=rahmen}

\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage{subfig} %for subfloat

\usepackage{cprotect}
%%%\AtBeginEnvironment{lstlisting}{
%%\renewcommand\ttfamily{\fontfamily{pcr}\selectfont}%}
\lstdefinelanguage{iPython} {
	morekeywords={access,and,del,except,exec,in,is,lambda,not,or,raise},
	morekeywords=[2]{for,print,abs,all,any,basestring,bin,bool,bytearray,callable,chr,classmethod,cmp,compile,complex,delattr,dict,dir,divmod,enumerate,eval,execfile,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,isinstance,issubclass,iter,len,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,property,range,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip,apply,buffer,coerce,intern,elif,else,if,continue,break,while,class,def,return,try,except,import,finally,try,except,from,global,pass, True, False},
	sensitive=true,
	morecomment=[l]\#,%
	morestring=[b]',%
	morestring=[b]",%
	moredelim=**[is][\color{black}]{@@}{@@},
	identifierstyle=\color{black}\footnotesize\ttfamily,
    commentstyle=\color{ipython-cyan}\footnotesize\itshape\ttfamily,
	stringstyle=\color{ipython-red}\footnotesize\ttfamily,
	keepspaces=true,
	showspaces=false,
    showstringspaces=false,
	rulecolor=\color{ipython-frame},
	frame=single,
	frameround={t}{t}{t}{t},
	framexleftmargin=6mm,
	numbers=left,
	numberstyle=\color{black},
	backgroundcolor=\color{ipython-bg},
	basicstyle=\footnotesize\ttfamily,
	keywordstyle=[2]\color{ipython-green}\bfseries\footnotesize\ttfamily, 
	keywordstyle=\color{ipython-purple}\bfseries\footnotesize\ttfamily
}

\lstdefinelanguage{iPythonnonumbers} {
	morekeywords={access,and,del,except,exec,in,is,lambda,not,or,raise},
	morekeywords=[2]{for,print,abs,all,any,basestring,bin,bool,bytearray,callable,chr,classmethod,cmp,compile,complex,delattr,dict,dir,divmod,enumerate,eval,execfile,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,isinstance,issubclass,iter,len,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,property,range,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip,apply,buffer,coerce,intern,elif,else,if,continue,break,while,class,def,return,try,except,import,finally,try,except,from,global,pass, True, False},
	sensitive=true,
	morecomment=[l]\#,%
	morestring=[b]',%
	morestring=[b]",%
	moredelim=**[is][\color{black}]{@@}{@@},
	identifierstyle=\color{black}\footnotesize\ttfamily,
	commentstyle=\color{ipython-cyan}\footnotesize\itshape\ttfamily,
	stringstyle=\color{ipython-red}\footnotesize\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	frame=single,
	frameround={t}{t}{t}{t},
	framexleftmargin=1mm,
	%numbers=left,
	%numberstyle=\color{ipython-cyan},
	backgroundcolor=\color{ipython-bg},
	%   extendedchars=true,
	basicstyle=\footnotesize\ttfamily,
	keywordstyle=[2]\color{ipython-green}\bfseries\footnotesize\ttfamily, 
	keywordstyle=\color{ipython-purple}\bfseries\footnotesize\ttfamily
}

\lstdefinelanguage{iOutput} {
	sensitive=true,
	identifierstyle=\color{black}\small\ttfamily,
	stringstyle=\color{ipython-red}\small\ttfamily,
	keepspaces=true,
	showspaces=false,
	showstringspaces=false,
	rulecolor=\color{ipython-frame},
	%frame=single,
	%frameround={t}{t}{t}{t},
	%backgroundcolor=\color{ipython-bg},
	basicstyle=\small\ttfamily,
}

\lstdefinestyle{mycpp}{language=C++,
	basicstyle=\small\ttfamily,
	showstringspaces=false,
	keywordstyle=\small\color{blue}\ttfamily,
	stringstyle=\small\color{red}\ttfamily,
	commentstyle=\small\color{green}\ttfamily,
	rulecolor=\color{ipython-frame},
	frame=single,
	frameround={t}{t}{t}{t},
	backgroundcolor=\color{ipython-bg},
	morecomment=[l][\color{magenta}]{\#}
}

\lstdefinestyle{attstyle}{
	backgroundcolor=\color{cream},
	rulecolor=\color{goldenrod}
}

\lstnewenvironment{attpython}[1][]{
	\lstset{language=iPython,style=attstyle,mathescape=true}
}{%
}

\lstnewenvironment{ipython}[1][]{\lstset{language=iPython,mathescape=true,escapeinside={*@}{@*}}%
}{%
}

\lstnewenvironment{ipythonnon}[1][]{\lstset{language=iPythonnonumbers,mathescape=true}%
}{%
}

\lstnewenvironment{ioutput}[1][]{\lstset{language=iOutput,mathescape=true,escapeinside={*@}{@*}}%
}{%
}

\newcommand{\pythoncode}[1]{
    \lstinputlisting[language=iPython,mathescape=true,escapeinside={*@}{@*}]{#1}
}

\newcommand{\pythoncodenon}[1]{
    \lstinputlisting[language=iPythonnonumbers,style=attstyle,mathescape=true,escapeinside={*@}{@*}]{#1}
}

\usepackage{fancyhdr}
\pagestyle{fancy}
%\renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markboth{\thesection.\ #1}{}}
\fancypagestyle{main}{
	\fancyhf{}
    \fancyhead[LO,RE]{\leftmark}
	\fancyhead[LE,RO]{\thepage}
	%\fancyfoot[C]{\thepage}
	\renewcommand{\headrulewidth}{0.4pt}
}
