
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Practical Lesson 4}
    \author {Matteo Sani \\\href{mailto:mattosan1@gmail.com}{matteosan1@gmail.com}}
       
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{forward-rates-and-classes---practical-lesson-4}{%
      \section{Forward Rates and Classes}
      \label{forward-rates-and-classes---practical-lesson-4}}

\hypertarget{recap}{%
\subsection{Recap}\label{recap}}

In the first three lessons we looked at:

\begin{itemize}
\tightlist
\item
  basic Python statements, expressions and objects (lists, dictionaries)
\item
  dates, tuples and functions
\item
  we started looking at how to implement functionality related to the
  theoretical lessons
\end{itemize}

\hypertarget{todays-lesson}{%
\subsection{Today's lesson}\label{todays-lesson}}

We're going to look at classes and while we talk about this topic we're
going to move ahead with implementing functionality related to the
theory lessons.

    \hypertarget{calculating-forward-rates}{%
\subsection{Calculating Forward Rates}\label{calculating-forward-rates}}

Last week we wrote a function called \texttt{df} for calculating a
discount factor at any date, given a set of discount factors each
relative to a corresponding pillar date, using log-linear interpolation.
Now we want a function to compute forward rates.

The formula to calculate the forward rates can be found exploiting the
property that investing at rate \(r_1\) for the period \((0, T_1)\) and
then \emph{reinvesting} at rate \(r_{1,2}\) for the time period
\((T_1, T_2)\) is equivalent to invest at rate \(r_2\) for the time
period \((0, T_2)\) (i.e.~no arbitrage condition, two investors
shouldn't be able to earn money from arbitraging between different
interest periods). That said:

\[(1+r_1 T_1)(1+r_{1,2}(T_2 - T_1)) = 1 + r_2 T_2\]

Solving for \(r_{1,2}\) leads to

\[F(T_1, T_2) = r_{1,2} = \frac{1}{T_2-T_1}\Big(\frac{D(T_1)}{D(T_2)} - 1 \Big)~~~~\textrm{(where $D{(T_i)}=\frac{1}{1+r_iT_{i}}$)}\]

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{date}
        \PY{k+kn}{import} \PY{n+nn}{numpy}\PY{o}{,} \PY{n+nn}{math}
        
        \PY{n}{today\PYZus{}date} \PY{o}{=} \PY{n}{date} \PY{p}{(}\PY{l+m+mi}{2019}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{pillar\PYZus{}dates} \PY{o}{=} \PY{p}{[}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2019} \PY{p}{,} \PY{l+m+mi}{1} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} 
                        \PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2020}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} 
                        \PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2021}\PY{p}{,} \PY{l+m+mi}{10} \PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
        \PY{n}{discount\PYZus{}factors} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{l+m+mf}{0.97}\PY{p}{,} \PY{l+m+mf}{0.72}\PY{p}{]}
        
        \PY{k}{def} \PY{n+nf}{df}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{p}{:}
            \PY{n}{log\PYZus{}discount\PYZus{}factors} \PY{o}{=} \PY{p}{[}\PY{n}{math}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{discount\PYZus{}factor}\PY{p}{)} \PYZbs{}
                                    \PY{k}{for} \PY{n}{discount\PYZus{}factor} \PY{o+ow}{in} \PY{n}{discount\PYZus{}factors}\PY{p}{]}
            \PY{n}{pillar\PYZus{}days} \PY{o}{=} \PY{p}{[}\PY{p}{(}\PY{n}{pillar\PYZus{}date} \PY{o}{\PYZhy{}} \PY{n}{today\PYZus{}date}\PY{p}{)}\PY{o}{.}\PY{n}{days} \PYZbs{}
                           \PY{k}{for} \PY{n}{pillar\PYZus{}date} \PY{o+ow}{in} \PY{n}{pillar\PYZus{}dates}\PY{p}{]}
            \PY{n}{d\PYZus{}days} \PY{o}{=} \PY{p}{(}\PY{n}{d} \PY{o}{\PYZhy{}} \PY{n}{today\PYZus{}date}\PY{p}{)}\PY{o}{.}\PY{n}{days}
            \PY{n}{interpolated\PYZus{}log\PYZus{}discount\PYZus{}factor} \PY{o}{=} \PYZbs{}
                \PY{n}{numpy}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{d\PYZus{}days}\PY{p}{,} \PY{n}{pillar\PYZus{}days}\PY{p}{,} \PY{n}{log\PYZus{}discount\PYZus{}factors}\PY{p}{)}
            
            \PY{k}{return} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{interpolated\PYZus{}log\PYZus{}discount\PYZus{}factor}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{forward\PYZus{}rate}\PY{p}{(}\PY{n}{t1}\PY{p}{,} \PY{n}{t2}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{l+m+mf}{365.0}\PY{o}{/}\PY{p}{(}\PY{n}{t2}\PY{o}{\PYZhy{}}\PY{n}{t1}\PY{p}{)}\PY{o}{.}\PY{n}{days} \PY{o}{*} \PY{p}{(}\PY{n}{df}\PY{p}{(}\PY{n}{t1}\PY{p}{)} \PY{o}{/} \PY{n}{df}\PY{p}{(}\PY{n}{t2}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{forward\PYZus{}rate}\PY{p}{(}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2019}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{date}\PY{p}{(}\PY{l+m+mi}{2019}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \hypertarget{financial-crisis}{%
\subsubsection{2008 Financial Crisis}\label{financial-crisis}}

Looking at the historical series of the Euribor (6M) rate versus the
Eonia Overnight Indexed Swap (OIS-6M) rate over the time interval
2006-2011 it becomes apparent how before August 2007 the two rates
display strictly overlapping trends differing of no more than 6 bps.

\includegraphics{credit_crunch.png}

In August 2007 however we observe a sudden increase of the Euribor rate
and a simultaneous decrease of the OIS rate that leads to the explosion
of the corresponding basis spread, touching the peak of 222 bps in
October 2008, when Lehman Brothers filed for bankruptcy protection.
Successively the basis has sensibly reduced and stabilized between 40
bps and 60 bps (notice that the pre-crisis level has never been
recovered). The same effect is observed for other similar couples,
e.g.~Euribor 3M vs OIS 3M.

The reason of the abrupt divergence between the Euribor and OIS rates
can be explained by considering both the monetary policy decisions
adopted by international authorities in response to the financial
turmoil, and the impact of the credit crunch on the credit and liquidity
risk perception of the market, coupled with the different financial
meaning and dynamics of these rates.

\begin{itemize}
\tightlist
\item
  The Euribor rate is the reference rate for over-the-counter (OTC)
  transactions in the Euro area. It is defined as ``the rate at which
  Euro interbank Deposits are being offered within the EMU zone by one
  prime bank to another at 11:00 a.m. Brussels time''. The rate fixings
  for a strip of 15 maturities, ranging from one day to one year, are
  constructed as the average of the rates submitted (excluding the
  highest and lowest 15\% tails) by a panel of banks 42 banks, selected
  among the EU banks with the highest volume of business in the Euro
  zone money markets, plus some large international bank from non-EU
  countries with important euro zone operations. \textbf{Thus, Euribor
  rates reflect the average cost of funding of banks in the interbank
  market at each given maturity. During the crisis the solvency and
  solidity of the whole financial sector was brought into question and
  the credit and liquidity risk and premia associated to interbank
  counterparties sharply increased.} The Euribor rates immediately
  reflected these dynamics and raise to their highest values over more
  than 10 years. As seen in the plot above, the Euribor 6M rate suddenly
  increased on August 2007 and reached 5.49\% on 10th October 2008.
\item
  The Eonia rate is the reference rate for overnight OTC transactions in
  the Euro area. It is constructed as the average rate of the overnight
  transactions (one day maturity deposits) executed during a given
  business day by a panel of banks on the interbank money market,
  weighted with the corresponding transaction volumes. \textbf{The Eonia
  Contribution Panel coincides with the Euribor Contribution Panel, thus
  Eonia rate includes information on the short term (overnight)
  liquidity expectations of banks in the Euro money market. It is also
  used by the European Central Bank (ECB) as a method of effecting and
  observing the transmission of its monetary policy actions. During the
  crisis the central banks were mainly concerned about restabilising the
  level of liquidity in the market, thus they reduced the level of the
  official rates.} Furthermore, the daily tenor of the Eonia rate makes
  negligible the credit and liquidity risks reflected on it: for this
  reason the OIS rates are considered the best proxies available in the
  market for the risk-free rate.
\end{itemize}

As a practial result, after the 2008 financial crisis, it is not
possible anymore to use a single discount curve to correctly price
forward rates of all tenors. For example, if we want to calculate the
net present value of a forward 6-month libor coupon, we need to
simultaneously use two different discount curves:

\begin{itemize}
\tightlist
\item
  the 6-month libor curve for determining the forward rate
\item
  the EONIA curve for discounting the expected cash flow
\end{itemize}

Essentially we are now going to explore how to implement the following
calculation:

\[\mathrm{NPV} = D_{\mathrm{EONIA}}(T_1) \times \frac{1}{T_2-T_1}\Big(\frac{D_{\mathrm{LIBOR}}(T_1)}{D_{\mathrm{LIBOR}}(T_2)} - 1 \Big)\]

\hypertarget{programming-problem}{%
\paragraph{Programming problem}\label{programming-problem}}

\textbf{We only have one \texttt{df} function, and one set of data
(i.e.~the curve inputs): how can we generalize what we have done so far
in such a way that we can conveniently do the above calculation ?}

One \emph{BAD} idea would be to write a different discount factor
function for each curve:

    \begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# THIS IS PSEUDOCODE JUST FOR ILLUSTRATION}
\NormalTok{eonia_pillar_dates }\OperatorTok{=}\NormalTok{ [date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), }
\NormalTok{                      date(}\DecValTok{2020}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{),  }
\NormalTok{                      date(}\DecValTok{2021}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)]}
\NormalTok{eonia_discount_factors }\OperatorTok{=}\NormalTok{ [}\FloatTok{1.0}\NormalTok{, }\FloatTok{0.95}\NormalTok{, }\FloatTok{0.8}\NormalTok{]}
\NormalTok{libor6m_pillar_dates }\OperatorTok{=}\NormalTok{ [date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{),  }
\NormalTok{                        date(}\DecValTok{2020}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{),  }
\NormalTok{                        date(}\DecValTok{2020}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)]}
\NormalTok{libor6m_discount_factors }\OperatorTok{=}\NormalTok{ [}\FloatTok{1.0}\NormalTok{, }\FloatTok{0.98}\NormalTok{, }\FloatTok{0.82}\NormalTok{]}

\KeywordTok{def}\NormalTok{ df_eonia(t):}
\NormalTok{    log_discount_factors }\OperatorTok{=}\NormalTok{ [math.log(discount_factor) }\OperatorTok{\textbackslash{}}
       \ControlFlowTok{for}\NormalTok{ discount_factor }\KeywordTok{in}\NormalTok{ eonia_discount_factors]}
\NormalTok{    interpolated_log_discount_factor }\OperatorTok{=} \OperatorTok{\textbackslash{}}
\NormalTok{       interp_over_dates(t, eonia_pillar_dates, }
\NormalTok{                         log_discount_factors)}
    \ControlFlowTok{return}\NormalTok{ math.exp(interpolated_log_discount_factor)}

\KeywordTok{def}\NormalTok{ df_libor(t):}
\NormalTok{    log_discount_factors }\OperatorTok{=}\NormalTok{ [math.log(discount_factor) }\OperatorTok{\textbackslash{}}
       \ControlFlowTok{for}\NormalTok{ discount_factor }\KeywordTok{in}\NormalTok{ libor6m_discount_factors]}
\NormalTok{    interpolated_log_discount_factor }\OperatorTok{=} \OperatorTok{\textbackslash{}}
\NormalTok{        numpy.interp(t, libor6m_pillar_dates, log_discount_factors)}
    \ControlFlowTok{return}\NormalTok{ math.exp(interpolated_log_discount_factor)}

\KeywordTok{def}\NormalTok{ forward_rate(t1, t2):}
    \ControlFlowTok{return} \FloatTok{365.0}\OperatorTok{/}\NormalTok{(t2 }\OperatorTok{-}\NormalTok{ t1).days }\OperatorTok{*}\NormalTok{ (df_libor(t1) }\OperatorTok{/}\NormalTok{ df_libor(t2) }\OperatorTok{-} \FloatTok{1.0}\NormalTok{)}

\NormalTok{rate }\OperatorTok{=}\NormalTok{ forward_rate(date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), date(}\DecValTok{2020}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{npv }\OperatorTok{=}\NormalTok{ df_eonia(date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)) }\OperatorTok{*}\NormalTok{ rate}
\end{Highlighting}
\end{Shaded}

    this becomes pretty laborious, since we need to rewrite a function for
every discount curve we add (e.g.~if we have another currency or more
libor rates with different tenors). Also, if we want to change the
behaviour of the df function (e.g.~change the type of interpolation), we
then have to go and change each single implementation
(\texttt{df\_eonia}, \texttt{df\_libor}, etc\ldots{}) so it's not a
convenient way of organizing the code.

An alternative could be to generalize the \texttt{df} function so that
it takes the pillar dates and discount factors as arguments, then we
pass in the data we want to use to calculate the interpolated discount
factor in each specific case:

    \begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# THIS IS PSEUDOCODE JUST FOR ILLUSTRATION}
\KeywordTok{def}\NormalTok{ df(pillar_dates, discount_factors, t):}
\NormalTok{    log_discount_factors }\OperatorTok{=}\NormalTok{ [math.log(discount_factor) }\OperatorTok{\textbackslash{}}
        \ControlFlowTok{for}\NormalTok{ discount_factor }\KeywordTok{in}\NormalTok{ discount_factors]}
\NormalTok{    interpolated_log_discount_factor }\OperatorTok{=} \OperatorTok{\textbackslash{}}
\NormalTok{        interp_over_dates(t, pillar_dates, log_discount_factors)}
    \ControlFlowTok{return}\NormalTok{ math.exp(interpolated_log_discount_factor)}

\KeywordTok{def}\NormalTok{ forward_rate(t1, t2):}
    \ControlFlowTok{return} \FloatTok{365.0} \OperatorTok{/}\NormalTok{ (t2 - t1).days }\OperatorTok{*}\NormalTok{ (}
\NormalTok{        df(libor6m_pillar_dates, libor6m_discount_factors, t1) }\OperatorTok{/}
\NormalTok{        df(libor6m_pillar_dates, libor6m_discount_factors, t2) - }\FloatTok{1.0}\NormalTok{)}

\NormalTok{rate }\OperatorTok{=}\NormalTok{ forward_rate(date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), date(}\DecValTok{2020}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{)) }\OperatorTok{\textbackslash{}}
    \OperatorTok{*}\NormalTok{ df(eonia_pillar_dates, eonia_discount_factors, date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

    This is still very inconvenient though, because we always have to pass a
set of static parameters to every function call. It's just about OK as
long as the parameter set is small (like in this case with only few
items) but as it gets larger it becomes unmanageable.

However, as we have seen, Python allows you to represent collections of
objects with dictionaries. A clear improvement could be, instead of
passing a long list of data parameters to each function call, to group
the datasets into dictionaries, and then pass those to the function.

    \begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# THIS IS PSEUDOCODE JUST FOR ILLUSTRATION}
\CommentTok{# One generalized df function, using dictionaries for representing datasets}

\NormalTok{eonia_data }\OperatorTok{=}\NormalTok{ \{}\StringTok{"pillar_dates"}\NormalTok{: [date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), }
\NormalTok{                               date(}\DecValTok{2020}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{),  }
\NormalTok{                               date(}\DecValTok{2021}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)],}
              \StringTok{"discount_factors"}\NormalTok{: [}\FloatTok{1.0}\NormalTok{, }\FloatTok{0.95}\NormalTok{, }\FloatTok{0.8}\NormalTok{]}
\NormalTok{             \}}
\NormalTok{libor6m_data }\OperatorTok{=}\NormalTok{ \{}\StringTok{"pillar_dates"}\NormalTok{: [date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), }
\NormalTok{                                 date(}\DecValTok{2020}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{), }
\NormalTok{                                 date(}\DecValTok{2020}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)],}
                \StringTok{"discount_factors"}\NormalTok{: [}\FloatTok{1.0}\NormalTok{, }\FloatTok{0.98}\NormalTok{, }\FloatTok{0.82}\NormalTok{]}
\NormalTok{             \}}
\KeywordTok{def}\NormalTok{ df(data, t):}
\NormalTok{    pillar_dates }\OperatorTok{=}\NormalTok{ data[}\StringTok{'pillar_dates'}\NormalTok{]}
\NormalTok{    discount_factors }\OperatorTok{=}\NormalTok{ data[}\StringTok{'discount_factors'}\NormalTok{]}
\NormalTok{    log_discount_factors }\OperatorTok{=}\NormalTok{ [math.log(discount_factor) }\OperatorTok{\textbackslash{}}
        \ControlFlowTok{for}\NormalTok{ discount_factor }\KeywordTok{in}\NormalTok{ discount_factors]}
\NormalTok{    interpolated_log_discount_factor }\OperatorTok{=} \OperatorTok{\textbackslash{}}
\NormalTok{        interp_over_dates(t, pillar_dates, log_discount_factors)}
    \ControlFlowTok{return}\NormalTok{ math.exp(interpolated_log_discount_factor)}

\KeywordTok{def}\NormalTok{ forward_rate(t1, t2):}
    \ControlFlowTok{return} \FloatTok{365.0}\OperatorTok{/}\NormalTok{(t2 - t1).days }\OperatorTok{*}\NormalTok{ (}
\NormalTok{        df(libor6m_data, t1) }\OperatorTok{/}
\NormalTok{        df(libor6m_data, t2) - }\FloatTok{1.0}\NormalTok{)}
        
\NormalTok{npv }\OperatorTok{=}\NormalTok{ df(eonia_data, date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)) }\OperatorTok{\textbackslash{}}
    \OperatorTok{*}\NormalTok{ forward_rate(date(}\DecValTok{2019}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{), date(}\DecValTok{2019}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

    This design pattern, i.e.~using dictionaries to group together data, and
then having functions operate on those dictionaries, perhaps with a few
additional parameters, is so useful that Python (and many other
programming languages) have a built-in feature that allows you to do
this conveniently: \textbf{classes}.

    \hypertarget{classes}{%
\subsection{Classes}\label{classes}}

Classes are a key ingredient of \emph{Object Oriented Programming} (OOP)
and their concept is implemented in many languages like \texttt{Python},
\texttt{Java}, \texttt{C++}. OOP is a programming model in which
programs are organized around data, or objects, rather than functions
and logic. \textbf{An object can be defined as a dataset with unique
attributes and behaviour} (examples can range from physical entities,
such as a human being that is described by properties like name and
birthday, down to abstract concepts as a discount curve). This opposes
the historical approach to programming where emphasis was placed on how
the logic was written rather than how to define the data within the
logic. In this framework classes are a mean for creating objects (a
particular data structure), providing initial values for state (member
variables or attributes), and implementations of behavior (member
functions or methods).

Let's summarize here some terminology:

\begin{itemize}
\tightlist
\item
  a class is a collection of related functions, and these are called the
  \emph{methods} of the class;
\item
  methods act on \emph{instances} of the class;
\item
  an \emph{instance} is basically a collection of related data;
\item
  each data item has a name, and those names are called the
  \emph{attributes} of the class.
\end{itemize}

\textbf{Essentially classes are collections of functions that operate on
a dataset, and instances of that class represent individual datasets (or
in othre words a specialization of that class).}

\begin{figure}
\centering
\includegraphics{classes_instances.png}
\caption{Graphical representation of a class instance.}
\end{figure}

Class methods always take the instance \texttt{self} as the first
argument, and fall into two categories:

\begin{itemize}
\tightlist
\item
  normal methods which use or modify the instance attributes;
\item
  special methods, which define the class behaviour: you can spot these
  because they start and end with two underscores (\_\_).
\end{itemize}

The \texttt{self} argument is very important since it allows a method to
use its class attributes.

There are lots of other things you can do with classes, but this is
enough for now. Let's take a look at an example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{date}
        
        \PY{c+c1}{\PYZsh{} this is the class definition}
        \PY{c+c1}{\PYZsh{} usually classes use camel naming convention}
        \PY{k}{class} \PY{n+nc}{Person}\PY{p}{:}
            
            \PY{c+c1}{\PYZsh{} the special method \PYZus{}\PYZus{}init\PYZus{}\PYZus{} allows to instanciate a class}
            \PY{c+c1}{\PYZsh{} with an initial dataset (in this example a name and a birthday)}
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{name}\PY{p}{,} \PY{n}{date\PYZus{}of\PYZus{}birth}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} attribute of the class Person}
                \PY{c+c1}{\PYZsh{} name and self.name are different variable !!!}
                \PY{c+c1}{\PYZsh{} name will be destroyed once \PYZus{}\PYZus{}init\PYZus{}\PYZus{} is processed}
                \PY{c+c1}{\PYZsh{} self.name lives with every particualar instance of Person}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{n}{name} 
                \PY{c+c1}{\PYZsh{} attribute of the class Person}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth} \PY{o}{=} \PY{n}{date\PYZus{}of\PYZus{}birth} 
                
            \PY{c+c1}{\PYZsh{} this normal method computes the current age of the}
            \PY{c+c1}{\PYZsh{} \PYZdq{}instanciated\PYZdq{} person}
            \PY{k}{def} \PY{n+nf}{age}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n}{today} \PY{o}{=} \PY{n}{date}\PY{o}{.}\PY{n}{today}\PY{p}{(}\PY{p}{)}
                \PY{n}{age} \PY{o}{=} \PY{n}{today}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{year}
                \PY{k}{if} \PY{n}{today}\PY{o}{.}\PY{n}{month} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{month} \PY{o+ow}{or} \PYZbs{}
                    \PY{n}{today}\PY{o}{.}\PY{n}{day} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{day}\PY{p}{:}
                    \PY{n}{age} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{return} \PY{n}{age}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} here we instanciate (create an instance of) the class }
        \PY{c+c1}{\PYZsh{} in other words we \PYZdq{}specialize\PYZdq{} a generic Person with some data}
        
        \PY{n}{me} \PY{o}{=} \PY{n}{Person}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Matteo}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{date}\PY{p}{(}\PY{l+m+mi}{1974}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{type}\PY{p}{(}\PY{n}{me}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \texttt{\_\_init\_\_} is the simplest example of special methods, it is
called every time a class is instanciated (e.g.~when you write me =
Person(\ldots{})) and initializes the attributes of the class.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} to access class attributes you have to use .}
        \PY{n}{me}\PY{o}{.}\PY{n}{name}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{me}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} to call a class method you have to use . }
        \PY{c+c1}{\PYZsh{} passing the parameters if needed}
        \PY{n}{me}\PY{o}{.}\PY{n}{age}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{date}
        
        \PY{c+c1}{\PYZsh{} let\PYZsq{}s add a new method to print in a nicer form }
        \PY{c+c1}{\PYZsh{} the age of the person}
        \PY{k}{class} \PY{n+nc}{Person}\PY{p}{:}
            
            \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{name}\PY{p}{,} \PY{n}{date\PYZus{}of\PYZus{}birth}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{n}{name}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth} \PY{o}{=} \PY{n}{date\PYZus{}of\PYZus{}birth}
            
            \PY{k}{def} \PY{n+nf}{age}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n}{today} \PY{o}{=} \PY{n}{date}\PY{o}{.}\PY{n}{today}\PY{p}{(}\PY{p}{)}
                \PY{n}{age} \PY{o}{=} \PY{n}{today}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{year}
                \PY{k}{if} \PY{n}{today}\PY{o}{.}\PY{n}{month} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{month} \PY{o+ow}{or} \PYZbs{}
                    \PY{n}{today}\PY{o}{.}\PY{n}{day} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{date\PYZus{}of\PYZus{}birth}\PY{o}{.}\PY{n}{day}\PY{p}{:}
                    \PY{n}{age} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{return} \PY{n}{age}
          
            \PY{c+c1}{\PYZsh{} methods in a class are just functions which can work}
            \PY{c+c1}{\PYZsh{} with the class attributes}
            \PY{c+c1}{\PYZsh{} Remember I told you functions can have no return ?}
            \PY{k}{def} \PY{n+nf}{print\PYZus{}age}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ is }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ years old right now}\PY{l+s+s2}{\PYZdq{}}\PYZbs{}
                       \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{name}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{age}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{her} \PY{o}{=} \PY{n}{Person}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Francesca}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{date}\PY{p}{(}\PY{l+m+mi}{1986}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{her}\PY{o}{.}\PY{n}{print\PYZus{}age}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \hypertarget{exercises}{%
\subsection{Exercises}\label{exercises}}

\hypertarget{exercise-4.1}{%
\subsubsection{Exercise 4.1}\label{exercise-4.1}}

Write two classes, \texttt{Circle} and \texttt{Rectangle} that given the
radius and height, width respectively allow to compute area and
perimeter of the two shapes. Test them with the following:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a_circle }\OperatorTok{=}\NormalTok{ Circle(}\DecValTok{5}\NormalTok{)}
\BuiltInTok{print}\NormalTok{ (}\StringTok{"My circle has an area of }\SpecialCharTok{\{\}}\StringTok{ m**2"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(a_circle.area()))}

\NormalTok{a_rectangle }\OperatorTok{=}\NormalTok{ Rectangle(}\DecValTok{3}\NormalTok{, }\DecValTok{6}\NormalTok{)}
\BuiltInTok{print}\NormalTok{ (}\StringTok{"My rectangle has a perimeter of }\SpecialCharTok{\{\}}\StringTok{ m and an area of }\SpecialCharTok{\{\}}\StringTok{ m**2"}\NormalTok{ \textbackslash{}}
\NormalTok{    .}\BuiltInTok{format}\NormalTok{(a_rectangle.perimeter(), a_rectangle.area()))}
\end{Highlighting}
\end{Shaded}

\hypertarget{exercise-4.2}{%
\subsubsection{Exercise 4.2}\label{exercise-4.2}}

Define a class \texttt{Songs}, its \texttt{\_\_init\_\_} should take as
input a dictionary (\texttt{lyrics} that contains lyrics line by line).
Define a method, \texttt{sing\_me\_a\_song} that prints each element of
the lyrics in his own line. Also test it with the follwing input.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lyrics }\OperatorTok{=}\NormalTok{ \{}\StringTok{"Wonderwall"}\NormalTok{:[}\StringTok{"Today is gonna be the day"}\NormalTok{,}
                        \StringTok{"That they're gonna throw it back to you"}\NormalTok{,}
                        \StringTok{"By now you should've somehow"}\NormalTok{, }\StringTok{"..."}\NormalTok{], }
          \StringTok{"Wish you were here"}\NormalTok{:  [}\StringTok{"So, so you think you can tell"}\NormalTok{,}
                                  \StringTok{"Heaven from hell"}\NormalTok{,}
                                   \StringTok{"Blue skies from pain"}\NormalTok{, }\StringTok{"..."}\NormalTok{]\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{exercise-4.3}{%
\subsubsection{Exercise 4.3}\label{exercise-4.3}}

Define a Point2D class that represent a point in a plane. Its
\texttt{\_\_init\_\_} method should accept the point coordinates
\texttt{x} and \texttt{y}. Write a method \texttt{distanceTo} that
compute the distance of the point to another passed as input. Test the
class by printing the distance of the point \(P=(4, 5)\) to the origin
\(P=(0,0)\) and to \(P=(3,4)\).

\hypertarget{exercise-4.4}{%
\subsubsection{Exercise 4.4}\label{exercise-4.4}}

Try to write a \texttt{DiscountCurve} class which contains the pillar
dates and pillar discount factors as attributes and which has methods
for calculating the discount factor and forward rate at arbitrary dates.

\hypertarget{hint}{%
\paragraph{Hint:}\label{hint}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# here goes import statement of the needed modules}
\ImportTok{import}\NormalTok{ ABCD}
\ImportTok{from}\NormalTok{ XYZ }\ImportTok{import}\NormalTok{ xyz}

\CommentTok{# usually classes have CamelCase naming convention}
\KeywordTok{class}\NormalTok{ DiscountCurve:}

    \CommentTok{# the special __init__ method defines }
    \CommentTok{# how to construct instances of the class}
    \CommentTok{# so you need to identify the attributes you need to store }
    \CommentTok{# in the class defining a discount curve}
    \KeywordTok{def} \FunctionTok{__init__}\NormalTok{(}\VariableTok{self}\NormalTok{, ...):}

    \CommentTok{# then we want to add a method to compute the discount}
    \CommentTok{# factor at an arbitrary value date }
    \CommentTok{# using the data stored in the instance}
    \KeywordTok{def}\NormalTok{ df(}\VariableTok{self}\NormalTok{, param1, param2, ...):}
      \CommentTok{# the implementation can follow what we did in the }
      \CommentTok{# function we wrote last week but this time has to }
      \CommentTok{# use the class attributes}
      
    \CommentTok{# finally we want a method to calculates the forward rate }
    \CommentTok{# based on the discount curve data stored in the instance}
    \KeywordTok{def}\NormalTok{ forward_rate(}\VariableTok{self}\NormalTok{, param1, param2, ...):}
        \CommentTok{# here of course we can use the df method }
        \CommentTok{# implemented above to calculate the forward rate}
\end{Highlighting}
\end{Shaded}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
