\chapter{Gaussian Quadrature}\label{gaussian-quadrature}

The integral in Eq.~\ref{eq:gaussian_quadrature} can be quite
complicated depending on the distribution of \(f_M\).

The Gaussian Quadrature is a technique that allows to approximate that
integral with a discrete weighted sum with weights determined by the
function \(f_M\). Assuming \(f\) is Gaussian we can write

\begin{equation}\int_{-\infty}^{+\infty}\cfrac{1}{\sqrt{2\pi}}e^{-F^{2}/2}g(F)dF\approx\sum_{k=1}^{k=N}w_k g(F_k)\end{equation}
As \(N\) increases the accuracy of the approximation increases, but usually
\(N=60\) is sufficient.

\href{https://drive.google.com/file/d/1Ic20cgVx4dpDG4W_pIHR4EXq9ens1G-H/view?usp=sharing}{Here} a dedicated class, \(\tt{GaussianQuadrature}\) is
available. Through the method \(\tt{M}\) returns the appropriate list of
weights \(w_k\) and values \(F_k\) to compute the intergral (it is
necessary to download also \href{https://drive.google.com/file/d/1zpQ0ubbEzniJb9usMWeeMCc0DSc2MGsC/view?usp=sharing}{this file} with all the values).

\begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{finmarkets} \PY{k}{import} \PY{n}{GaussianQuadrature}
	
\PY{n}{gq} \PY{o}{=} \PY{n}{GaussianQuadrature}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{values: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{gq}\PY{o}{.}\PY{n}{M}\PY{p}{(}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{weights: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{gq}\PY{o}{.}\PY{n}{M}\PY{p}{(}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

values:  [14.36715008, 13.46459111, 12.71717121, 12.04990464, 11.43418345,
10.85527694, 10.30435118, 9.775583711, 9.264879565, 8.769218063, 8.286287662,
7.814266859, 7.351685308, 6.897331785, 6.450190946, 6.009398508, 5.574208647,
5.143969727, 4.718105868, 4.296102681, 3.877496046, 3.461863141, 3.048815156,
2.637991292, 2.229053735, 1.821683385, 1.415576157, 1.010439725, 0.605990602,
0.201951448, -0.201951448, -0.605990602, -1.010439725, -1.415576157,
-1.821683385, -2.229053735, -2.637991292, -3.048815156, -3.461863141,
-3.877496046, -4.296102681, -4.718105868, -5.143969727, -5.574208647,
-6.009398508, -6.450190946, -6.897331785, -7.351685308, -7.814266859,
-8.286287662, -8.769218063, -9.264879565, -9.775583711, -10.30435118,
-10.85527694, -11.43418345, -12.04990464, -12.71717121, -13.46459111,
-14.36715008]
weights:  [6.26018e-46, 1.37648e-40, 2.12791e-36, 7.51816e-33, 9.67908e-30,
5.8078e-27, 1.88764e-24, 3.67432e-22, 4.6002e-20, 3.90602e-18, 2.34277e-16,
1.02492e-14, 3.35604e-13, 8.40054e-12, 1.63579e-10, 2.51449e-09, 3.08925e-08,
3.06553e-07, 2.47921e-06, 1.64672e-05, 9.04268e-05, 0.000412859, 0.001574836,
0.005039442, 0.013575119, 0.030871873, 0.059408466, 0.096914318, 0.134203158,
0.157890214, 0.157890214, 0.134203158, 0.096914318, 0.059408466, 0.030871873,
0.013575119, 0.005039442, 0.001574836, 0.000412859, 9.04268e-05, 1.64672e-05,
2.47921e-06, 3.06553e-07, 3.08925e-08, 2.51449e-09, 1.63579e-10, 8.40054e-12,
3.35604e-13, 1.02492e-14, 2.34277e-16, 3.90602e-18, 4.6002e-20, 3.67432e-22,
1.88764e-24, 5.8078e-27, 9.67908e-30, 7.51816e-33, 2.12791e-36, 1.37648e-40,
6.26018e-46]
\end{Verbatim}
\end{tcolorbox}
